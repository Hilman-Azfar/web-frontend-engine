import { Meta } from "@storybook/addon-docs";
import { VersionTags } from "./version-tag.tsx";

<Meta title="Introduction/Getting Started" />

# LifeSG Frontend Engine v2

<VersionTags link="https://github.com/LifeSG/web-frontend-engine" />

A form building library to come up with forms with relative ease.

-   UI components based on react-lifesg-design-system
-   Form generation via JSON schema

### Alpha status ⚠️

The library is actively in development stage and is aiming for MVP release. With that, the priority is on ensuring the form fields work properly and can be defined through the JSON schema. It is also assumed that all the necessary form fields are provided by Frontend Engine.

While it is possible to pass custom components into Frontend Engine, it is largely unsupported as this feature is deprioritised, so use at your own risk! The current assumption is all form fields will exist inside Frontend Engine.

### Purpose

The purpose of Frontend Engine is to take out the heavy lifting of form development and offer a collection of common fields so engineers can develop forms quickly. Forms can be defined through a JSON schema so non-engineers can customise them as well.

### Design system

Frontend Engine is developed based on [react-lifesg-design-system](https://bitbucket.ship.gov.sg/projects/PUSH/repos/react-lifesg-design-system/browse). It relies on the design system for colours, theming, grid system and components. For more details on customising / usage / guidelines, please refer to its [storybook](https://www.dev.lifesg.io/storybook/lifesg/index.html?path=/story/introduction-getting-started--page).

### React Form Hook and Yup

Under the hood, the Frontend Engine relies on [React Form Hook](https://react-hook-form.com/) as the form library. React Form Hook in turn relies on [Yup](https://github.com/jquense/yup) to come up with the validation rules. If you are intending to work with this library, it will be beneficial to be familiar with the libraries and their concepts.

## Installation

Add this library as a dependency in your project's `package.json`

```json

"web-frontend-engine": "TO INSERT URL"
// ?.?.? is the version tag of the built branch

```

Install the library

```bash
npm i web-frontend-engine
```

### node-canvas build error

When building in bamboo, you may encounter an error with node-canvas

```
node-pre-gyp ERR! install response status 404 Not Found on https://github.com/Automattic/node-canvas/releases/download/v2.9.1/canvas-v2.9.1-node-v72-linux-musl-x64.tar.gz
node-pre-gyp WARN Pre-built binaries not installable for canvas@2.9.1 and node@12.22.6 (node-v72 ABI, musl) (falling back to source compile with node-gyp)
node-pre-gyp WARN Hit error response status 404 Not Found on https://github.com/Automattic/node-canvas/releases/download/v2.9.1/canvas-v2.9.1-node-v72-linux-musl-x64.tar.gz
```

This is happening because node-canvas needs a special build agent that is on node16. In order to use that, you will need to update the bamboo plan configuration to use `gtgovandi/agent-alpha:2.0.0` docker image.

## Usage

### 1. Define the JSON schema

Frontend Engine accepts the JSON schema through the data props, the shape is defined in the `IFrontendEngineData` interface. Do refer to the individual Frontend Engine stories for more details.

```json
{
	"fields": [
		{
			"id": "name",
			"title": "What is your name",
			"type": "TEXTAREA",
			"required": true
		},
		{
			"id": "age",
			"title": "Age",
			"type": "NUMBER",
			"validation": ["required"]
		}
	]
}
```

### 2. Using the Frontend Engine component

Render Frontend Engine component accordingly:

```tsx
import React from "react";
import { FrontendEngine } from "web-frontend-engine";
import { IFrontendEngineData } from "web-frontend-engine/types";
import data from "./data.json";

const MyForm = () => {
	return <FrontendEngine data={data as IFrontendEngineData} />;
};

export default MyForm;
```
